version: 0.0.7                # minimum Brock version required to use this config
project: someprojectname      # name of the project
help: "brock --help message"  # optional
commands:                     # optional
  default: build              # optional - default command to run when no command specified, can be ommited if just one command is configured
  clean:
    default_executor: atollic # optional - default executor to use for this command
    chdir: foo/bar            # optional - switch to this directory relative to base config prior execution
    help: "Help message for this command"   # optional - help to be show in brock --help
    steps:
      - make clean            # run `make clean` in default executor (overriden to atollic here)
  build:
    depends_on:               # optinal - list of commands to run prior steps execution
      - clean
    steps:
      - "@atollic make"       # run `make` command in atollic executor
      - make tests            # run `make tests` in python (set as default) executor
      - "@host echo 'Building finished'"  # run command on the host computer
  rebuild:
    depends_on:               # dependencies only command, no steps need to be defined
      - clean
      - build
  service:
    steps:
      - executor: atollic     # optional
        shell: powershell     # optional
        script: |
          $ServiceName = 'EventLog'
          $ServiceInfo = Get-Service -Name $ServiceName
          Write-Output $ServiceInfo

executors:                    # optional - if not present, only host executor can be used
  default: python             # optional - default executor, if no executors are defined host executor is used, can be ommited if just one executor is configured
  atollic:
    type: docker              # type of the executor, each type has a different arguments
    help: "Executor --help message" # optional
    dockerfile: path/to/Dockerfile  # build custom image from docker file
    platform: windows         # optional - linux assumed by default
    env:                      # optional - env variables to pass to container
      SOME_VAR: foo
      OTHER_VAR: 123
    mac_address: 88:99:aa:bb:cc:dd # optional - custom MAC address of the container
    devices:                  # optional - pass devices to windows containers (isolation=process only)
      # https://docs.microsoft.com/en-us/virtualization/windowscontainers/deploy-containers/hardware-devices-in-containers
      - class/{interface class GUID}
    default_shell: powershell # optional - default shell (if not specified, sh or cmd is used based on executor platform)
  python:
    type: docker
    image: python:3.9         # use image from registry
    sync:                     # optional - sync files to container instead of direct mount for faster build times on linux containers under windows
      type: rsync             # only rsync mode currently supported
      options:                # optional - rsync parameters
        - "-avm"
      filter:                 # optional - rsync --filter rules. It is recommended to not use include and exclude if filter is used
        - "+ foo/"            # add foo directory to path
        - "+ foo/**/"         # add all subdirectories in foo/ to path
        - "+ foo/**.c"        # add all files ending with `.c` in foo and all its subdirectories
        - "+ foo/src/**"      # add all files in foo/src/ and all its subdirectories
        - "- *"               # exclude all other files
      include:                # optional - directories to include to syncing (applied before exclude)
        - foo/bar
      exclude:                # optional - directories to exclude from syncing
        - foo/bar
    devices:                  # optional - mount devices to container - works only for linux containers on linux host
      - /dev/ttyUSB0:/dev/ttyUSB0:rwm   # <host_path>:<container_path>:<cgroup_permissions>
    prepare:                  # optional, commands to run after starting a container
      - pip install -r requirements.txt
      - echo "Foo bar"
  remote:
    type: ssh
    host: somesite.example.com:1235 # SSH host to run the commands on
    username: foobar          # optional - user on the remote machine
    password: strongpassword  # optional - password for the user
